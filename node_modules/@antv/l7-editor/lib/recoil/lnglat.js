var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/recoil/lnglat.ts
var lnglat_exports = {};
__export(lnglat_exports, {
  default: () => useLnglat
});
module.exports = __toCommonJS(lnglat_exports);
var import_turf = require("@turf/turf");
var import_lodash_es = require("lodash-es");
var import_react_i18next = require("react-i18next");
var import_recoil = require("recoil");
var import_constants = require("../constants");
var import_atomState = require("./atomState");
function useLnglat() {
  const [lngLatImportType, setLngLatImportType] = (0, import_recoil.useRecoilState)(import_atomState.lnglatTypeState);
  const { t } = (0, import_react_i18next.useTranslation)();
  const [lngLatText, setLngLatText] = (0, import_recoil.useRecoilState)(import_atomState.lnglatTextState);
  const importLngLatText = (text) => {
    const featurePositionList = text.split("\n").filter((item) => item).map(
      (item) => item.split(";").filter((str) => str).map(
        (str) => str.split(",").filter((num) => num).map((num) => +num)
      )
    );
    if (import_constants.LngLatVT.check(featurePositionList)) {
      const newFeatures = [];
      if (lngLatImportType === "Point") {
        newFeatures.push(
          ...featurePositionList.flat().map((position) => (0, import_turf.point)(position))
        );
      } else if (lngLatImportType === "LingString") {
        newFeatures.push(
          ...featurePositionList.map((positions) => (0, import_turf.lineString)(positions))
        );
      } else {
        newFeatures.push(
          ...featurePositionList.map((positions) => {
            if (!(0, import_lodash_es.isEqual)((0, import_lodash_es.first)(positions), (0, import_lodash_es.last)(positions))) {
              positions.push(positions[0]);
            }
            return (0, import_turf.polygon)([positions]);
          })
        );
      }
      return newFeatures;
    } else {
      throw new Error(t("import_btn.lnglat_import_btn.lNGLA"));
    }
  };
  return {
    lngLatImportType,
    setLngLatImportType,
    lngLatText,
    setLngLatText,
    importLngLatText
  };
}
